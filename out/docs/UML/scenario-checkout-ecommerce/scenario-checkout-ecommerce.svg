<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1114px" preserveAspectRatio="none" style="width:2727px;height:1114px;" version="1.1" viewBox="0 0 2727 1114" width="2727px" zoomAndPan="magnify"><defs><filter height="300%" id="fhouz29cib6gu" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="645" x="1037.75" y="28.708">Scénario 3: Workflow E-commerce Complet - Panier à Commande Finale</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="45" x2="45" y1="123.25" y2="1030.6328"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="416.5" x2="416.5" y1="123.25" y2="1030.6328"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="779" x2="779" y1="123.25" y2="1030.6328"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1253.5" x2="1253.5" y1="123.25" y2="1030.6328"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1477" x2="1477" y1="123.25" y2="1030.6328"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1781" x2="1781" y1="123.25" y2="1030.6328"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="2007" x2="2007" y1="123.25" y2="1030.6328"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="2218" x2="2218" y1="123.25" y2="1030.6328"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="2382" x2="2382" y1="123.25" y2="1030.6328"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="2665.5" x2="2665.5" y1="123.25" y2="1030.6328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="5" y="119.9482">Client Web</text><ellipse cx="45" cy="49.9531" fill="#FEFECE" filter="url(#fhouz29cib6gu)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M45,57.9531 L45,84.9531 M32,65.9531 L58,65.9531 M45,84.9531 L32,99.9531 M45,84.9531 L58,99.9531 " fill="none" filter="url(#fhouz29cib6gu)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="5" y="1042.6279">Client Web</text><ellipse cx="45" cy="1055.9297" fill="#FEFECE" filter="url(#fhouz29cib6gu)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M45,1063.9297 L45,1090.9297 M32,1071.9297 L58,1071.9297 M45,1090.9297 L32,1105.9297 M45,1090.9297 L58,1105.9297 " fill="none" filter="url(#fhouz29cib6gu)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#fhouz29cib6gu)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="169" x="330.5" y="87.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="155" x="337.5" y="107.9482">Frontend E-commerce</text><rect fill="#FEFECE" filter="url(#fhouz29cib6gu)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="169" x="330.5" y="1029.6328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="155" x="337.5" y="1049.6279">Frontend E-commerce</text><rect fill="#FEFECE" filter="url(#fhouz29cib6gu)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="136" x="709" y="87.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122" x="716" y="107.9482">EcommerceClient</text><rect fill="#FEFECE" filter="url(#fhouz29cib6gu)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="136" x="709" y="1029.6328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122" x="716" y="1049.6279">EcommerceClient</text><rect fill="#FEFECE" filter="url(#fhouz29cib6gu)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="113" x="1195.5" y="87.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="1202.5" y="107.9482">Kong Gateway</text><rect fill="#FEFECE" filter="url(#fhouz29cib6gu)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="113" x="1195.5" y="1029.6328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="1202.5" y="1049.6279">Kong Gateway</text><rect fill="#FEFECE" filter="url(#fhouz29cib6gu)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="192" x="1379" y="87.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="178" x="1386" y="107.9482">service-ecommerce:8005</text><rect fill="#FEFECE" filter="url(#fhouz29cib6gu)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="192" x="1379" y="1029.6328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="178" x="1386" y="1049.6279">service-ecommerce:8005</text><rect fill="#FEFECE" filter="url(#fhouz29cib6gu)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="208" x="1675" y="87.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="194" x="1682" y="107.9482">CreerCompteClientUseCase</text><rect fill="#FEFECE" filter="url(#fhouz29cib6gu)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="208" x="1675" y="1029.6328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="194" x="1682" y="1049.6279">CreerCompteClientUseCase</text><rect fill="#FEFECE" filter="url(#fhouz29cib6gu)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="217" x="1897" y="87.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="203" x="1904" y="107.9482">AjouterProduitPanierUseCase</text><rect fill="#FEFECE" filter="url(#fhouz29cib6gu)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="217" x="1897" y="1029.6328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="203" x="1904" y="1049.6279">AjouterProduitPanierUseCase</text><rect fill="#FEFECE" filter="url(#fhouz29cib6gu)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="177" x="2128" y="87.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="163" x="2135" y="107.9482">service-catalogue:8001</text><rect fill="#FEFECE" filter="url(#fhouz29cib6gu)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="177" x="2128" y="1029.6328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="163" x="2135" y="1049.6279">service-catalogue:8001</text><rect fill="#FEFECE" filter="url(#fhouz29cib6gu)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="122" x="2319" y="87.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="2326" y="107.9482">ecommerce_db</text><rect fill="#FEFECE" filter="url(#fhouz29cib6gu)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="122" x="2319" y="1029.6328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="2326" y="1049.6279">ecommerce_db</text><rect fill="#FEFECE" filter="url(#fhouz29cib6gu)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="96" x="2615.5" y="87.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="2622.5" y="107.9482">produits_db</text><rect fill="#FEFECE" filter="url(#fhouz29cib6gu)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="96" x="2615.5" y="1029.6328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="2622.5" y="1049.6279">produits_db</text><rect fill="#EEEEEE" filter="url(#fhouz29cib6gu)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="2720.5" x="0" y="153.8164"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2720.5" y1="153.8164" y2="153.8164"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2720.5" y1="156.8164" y2="156.8164"/><rect fill="#EEEEEE" filter="url(#fhouz29cib6gu)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="256" x="1232.25" y="143.25"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="237" x="1238.25" y="159.3169">Phase 1: Création compte client</text><polygon fill="#A80036" points="405,208.6484,415,212.6484,405,216.6484,409,212.6484" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="45" x2="411" y1="212.6484" y2="212.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151" x="52" y="192.4497">Inscription e-commerce</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="52" y="207.5825">/clients/creer-compte/</text><polygon fill="#A80036" points="767,237.7813,777,241.7813,767,245.7813,771,241.7813" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="417" x2="773" y1="241.7813" y2="241.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="329" x="424" y="236.7153">creer_compte_client(prenom, nom, email, adresse)</text><polygon fill="#A80036" points="1242,282.0469,1252,286.0469,1242,290.0469,1246,286.0469" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="779" x2="1248" y1="286.0469" y2="286.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="786" y="265.8481">POST /api/ecommerce/api/clients/</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="272" x="786" y="280.981">{prenom, nom, email, adresse_complete}</text><polygon fill="#A80036" points="1465,311.1797,1475,315.1797,1465,319.1797,1469,315.1797" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1254" x2="1471" y1="315.1797" y2="315.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199" x="1261" y="310.1138">Route vers service-ecommerce</text><polygon fill="#A80036" points="1769,340.3125,1779,344.3125,1769,348.3125,1773,344.3125" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1477" x2="1775" y1="344.3125" y2="344.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="1484" y="339.2466">execute(donnees_client)</text><path d="M1786,357.3125 L1786,427.3125 L2023,427.3125 L2023,367.3125 L2013,357.3125 L1786,357.3125 " fill="#FBFB77" filter="url(#fhouz29cib6gu)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M2013,357.3125 L2013,367.3125 L2023,367.3125 L2013,357.3125 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="117" x="1792" y="374.3794">Validation DDD:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172" x="1792" y="389.5122">• Value Object: EmailClient</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="209" x="1792" y="404.645">• Value Object: AdresseLivraison</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="216" x="1792" y="419.7778">• Entité: Client avec règles métier</text><polygon fill="#A80036" points="2370,469.1094,2380,473.1094,2370,477.1094,2374,473.1094" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1781" x2="2376" y1="473.1094" y2="473.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="438" x="1788" y="452.9106">INSERT INTO client (prenom, nom, email, adresse_rue, adresse_ville)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="1788" y="468.0435">VALUES (?, ?, ?, ?, ?)</text><polygon fill="#A80036" points="1792,498.2422,1782,502.2422,1792,506.2422,1788,502.2422" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1786" x2="2381" y1="502.2422" y2="502.2422"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="353" x="1798" y="497.1763">client_id = "aaaaaaaa-bbbb-cccc-dddd-eeeeeeeeeeee"</text><polygon fill="#A80036" points="1488,527.375,1478,531.375,1488,535.375,1484,531.375" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1482" x2="1780" y1="531.375" y2="531.375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="280" x="1494" y="526.3091">{"success": true, "client_id": "aaaaaaaa-..."}</text><polygon fill="#A80036" points="428,556.5078,418,560.5078,428,564.5078,424,560.5078" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="422" x2="1476" y1="560.5078" y2="560.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165" x="434" y="555.4419">Compte créé avec succès</text><polygon fill="#A80036" points="56,585.6406,46,589.6406,56,593.6406,52,589.6406" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="50" x2="416" y1="589.6406" y2="589.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="348" x="62" y="584.5747">"Compte créé ! Vous pouvez maintenant commander"</text><rect fill="#EEEEEE" filter="url(#fhouz29cib6gu)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="2720.5" x="0" y="618.207"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2720.5" y1="618.207" y2="618.207"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2720.5" y1="621.207" y2="621.207"/><rect fill="#EEEEEE" filter="url(#fhouz29cib6gu)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="268" x="1226.25" y="607.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="249" x="1232.25" y="623.7075">Phase 2: Ajout produits au panier</text><polygon fill="#A80036" points="405,657.9063,415,661.9063,405,665.9063,409,661.9063" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="45" x2="411" y1="661.9063" y2="661.9063"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="220" x="52" y="656.8403">Recherche produit "Écran Gaming"</text><polygon fill="#A80036" points="767,687.0391,777,691.0391,767,695.0391,771,691.0391" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="417" x2="773" y1="691.0391" y2="691.0391"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="278" x="424" y="685.9731">rechercher_produits(nom="Écran Gaming")</text><polygon fill="#A80036" points="1242,716.1719,1252,720.1719,1242,724.1719,1246,720.1719" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="779" x2="1248" y1="720.1719" y2="720.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="451" x="786" y="715.106">GET /api/catalogue/api/ddd/catalogue/rechercher/?nom=Écran Gaming</text><polygon fill="#A80036" points="2206.5,745.3047,2216.5,749.3047,2206.5,753.3047,2210.5,749.3047" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1254" x2="2212.5" y1="749.3047" y2="749.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="230" x="1261" y="744.2388">Route vers catalogue (load balancé)</text><polygon fill="#A80036" points="2653.5,774.4375,2663.5,778.4375,2653.5,782.4375,2657.5,778.4375" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="2218.5" x2="2659.5" y1="778.4375" y2="778.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="387" x="2225.5" y="773.3716">SELECT * FROM produit WHERE nom ILIKE '%Écran Gaming%'</text><polygon fill="#A80036" points="2229.5,803.5703,2219.5,807.5703,2229.5,811.5703,2225.5,807.5703" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="2223.5" x2="2664.5" y1="807.5703" y2="807.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="423" x="2235.5" y="802.5044">[{"id": "11111111-...", "nom": "Écran Gaming 24\"", "prix": 299.99}]</text><polygon fill="#A80036" points="428,832.7031,418,836.7031,428,840.7031,424,836.7031" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="422" x2="2217.5" y1="836.7031" y2="836.7031"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="434" y="831.6372">Liste produits trouvés</text><polygon fill="#A80036" points="405,876.9688,415,880.9688,405,884.9688,409,880.9688" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="45" x2="411" y1="880.9688" y2="880.9688"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="52" y="860.77">Clic "Ajouter au panier"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="245" x="52" y="875.9028">produit_id="11111111-...", quantite=2</text><polygon fill="#A80036" points="767,906.1016,777,910.1016,767,914.1016,771,910.1016" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="417" x2="773" y1="910.1016" y2="910.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="338" x="424" y="905.0356">ajouter_produit_panier(client_id, produit_id, quantite)</text><polygon fill="#A80036" points="1242,950.3672,1252,954.3672,1242,958.3672,1246,954.3672" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="779" x2="1248" y1="954.3672" y2="954.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="382" x="786" y="934.1685">POST /api/ecommerce/api/panier/clients/aaaaaaaa.../panier/</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="786" y="949.3013">{produit_id, quantite: 2}</text><polygon fill="#A80036" points="1465,979.5,1475,983.5,1465,987.5,1469,983.5" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1254" x2="1471" y1="983.5" y2="983.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199" x="1261" y="978.4341">Route vers service-ecommerce</text><polygon fill="#A80036" points="1995.5,1008.6328,2005.5,1012.6328,1995.5,1016.6328,1999.5,1012.6328" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1477" x2="2001.5" y1="1012.6328" y2="1012.6328"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="245" x="1484" y="1007.5669">execute(client_id, produit_id, quantite)</text><!--MD5=[f34877e2c94e965608242be98dd4698e]
@startuml scenario-checkout-ecommerce
title Scénario 3: Workflow E-commerce Complet - Panier à Commande Finale

actor "Client Web" as Client
participant "Frontend E-commerce" as Frontend
participant "EcommerceClient" as EcoClient
participant "Kong Gateway" as Kong
participant "service-ecommerce:8005" as EcommerceService
participant "CreerCompteClientUseCase" as ClientUC
participant "AjouterProduitPanierUseCase" as PanierUC
participant "service-catalogue:8001" as CatalogueService
participant "ecommerce_db" as EcoDB
participant "produits_db" as ProdDB

== Phase 1: Création compte client ==
Client -> Frontend : Inscription e-commerce\n/clients/creer-compte/
Frontend -> EcoClient : creer_compte_client(prenom, nom, email, adresse)
EcoClient -> Kong : POST /api/ecommerce/api/clients/\n{prenom, nom, email, adresse_complete}
Kong -> EcommerceService : Route vers service-ecommerce

EcommerceService -> ClientUC : execute(donnees_client)
note right of ClientUC : **Validation DDD:**\n• Value Object: EmailClient\n• Value Object: AdresseLivraison\n• Entité: Client avec règles métier

ClientUC -> EcoDB : INSERT INTO client (prenom, nom, email, adresse_rue, adresse_ville)\nVALUES (?, ?, ?, ?, ?)
EcoDB -> ClientUC : client_id = "aaaaaaaa-bbbb-cccc-dddd-eeeeeeeeeeee"
ClientUC -> EcommerceService : {"success": true, "client_id": "aaaaaaaa-..."}
EcommerceService -> Frontend : Compte créé avec succès
Frontend -> Client : "Compte créé ! Vous pouvez maintenant commander"

== Phase 2: Ajout produits au panier ==
Client -> Frontend : Recherche produit "Écran Gaming"
Frontend -> EcoClient : rechercher_produits(nom="Écran Gaming")
EcoClient -> Kong : GET /api/catalogue/api/ddd/catalogue/rechercher/?nom=Écran Gaming
Kong -> CatalogueService : Route vers catalogue (load balancé)

CatalogueService -> ProdDB : SELECT * FROM produit WHERE nom ILIKE '%Écran Gaming%'
ProdDB -> CatalogueService : [{"id": "11111111-...", "nom": "Écran Gaming 24\"", "prix": 299.99}]
CatalogueService -> Frontend : Liste produits trouvés

Client -> Frontend : Clic "Ajouter au panier"\nproduit_id="11111111-...", quantite=2
Frontend -> EcoClient : ajouter_produit_panier(client_id, produit_id, quantite)
EcoClient -> Kong : POST /api/ecommerce/api/panier/clients/aaaaaaaa.../panier/\n{produit_id, quantite: 2}
Kong -> EcommerceService : Route vers service-ecommerce

EcommerceService -> PanierUC : execute(client_id, produit_id, quantite)
@enduml

PlantUML version 1.2021.00(Sun Jan 10 10:25:05 UTC 2021)
(MIT source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>